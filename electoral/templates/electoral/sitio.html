{% load l10n %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta name="author" content="Fabio Rueda" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>{% block title %}Formulas Electorales (Beta Version){% endblock %}</title>
		<style type="text/css" media="all">
			@import "/static/style.css";
			@import url(http://fonts.googleapis.com/css?family=Unlock|Signika:400,600,700);
		</style>
		<link type="text/css" href="/static/jquery-ui/css/jquery-ui.css" rel="stylesheet" />     
		<script type="text/javascript" src="/static/jquery-ui/js/jquery-1.6.2.min.js"></script>
		<script type="text/javascript" src="/static/jquery-ui/js/jquery-ui-1.8.16.custom.min.js"></script>

		{% block demoleakbar %}
		<!-- jquery-ui para la progress bar-->
		<script type="text/javascript">
			$(function(){
				// Progressbar
				$("#progressbar-n").progressbar({
					"value": {{ sitio.demoleak|unlocalize }}
				});
				// http://jqueryui.com/demos/progressbar/#animated
				$("#progressbar-n").css({ 'background': 'white' });
				{% if sitio.demoleak < 10 %}
					$("#progressbar-n > div").css({  'background': 'green'   });
				{% else %}
					$("#progressbar-n > div").css({  'background': 'red'   });
				{% endif %}


			});
		</script>
		{% endblock %}
		
		
		{% for partido in sitio.partidos.all %}
		<script type="text/javascript">
			$(function(){
				// Progressbar
				$("#progressbar-{{partido.id|unlocalize}}").progressbar({
					"value": {{ partido.demoleak|unlocalize }}
				});
				// http://jqueryui.com/demos/progressbar/#animated
				$("#progressbar-{{partido.id|unlocalize}}").css({ 'background': 'white' });
				{% if partido.demoleak > 10 %}
				$("#progressbar-{{partido.id|unlocalize}} > div").css({  'background': 'red'   });
				{% endif %}
				{% if  partido.demoleak > 5 and partido.demoleak < 10 %}
				$("#progressbar-{{partido.id|unlocalize}} > div").css({  'background': 'yellow'   });
				{% endif %}
				{% if partido.demoleak < 5 %}
					$("#progressbar-{{partido.id|unlocalize}} > div").css({  'background': 'green'   });
				{% endif %}

			});
		</script>
		{% endfor %}


		<!-- AJAX piechart votos-->
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script type="text/javascript">

	    // Load the Visualization API and the piechart package.
		google.load('visualization', '1.0', {'packages':['corechart']});

		// Set a callback to run when the Google Visualization API is loaded.
		google.setOnLoadCallback(drawChart);

		// Callback that creates and populates a data table, 
		// instantiates the pie chart, passes in the data and
		// draws it.
		function drawChart() {

			// Create the data table.
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Partido');
			data.addColumn('number', 'Votos');
			
			data.addRows([
					{% for partido in sitio.partidos.all %}
					['{{partido.nombre}}',{{ partido.votos_numero|unlocalize }}],
					{% endfor %}
					]);

			// Set chart options
			var options = {'title':'Porcentaje de votos en {{ sitio.nombre }}',
				'width':360,
				'height':200,
				'backgroundColor':'#f4f4f4'
				};

			// Instantiate and draw our chart, passing in some options.
			var chart = new google.visualization.PieChart(document.getElementById('chart_votos'));
			chart.draw(data, options);
		}

		</script>
		<!-- AJAX piechart escaños-->
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script type="text/javascript">

			// Load the Visualization API and the piechart package.
		google.load('visualization', '1.0', {'packages':['corechart']});

		// Set a callback to run when the Google Visualization API is loaded.
		google.setOnLoadCallback(drawChart);

		// Callback that creates and populates a data table, 
		// instantiates the pie chart, passes in the data and
		// draws it.
		function drawChart() {

			// Create the data table.
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Partido');
            data.addColumn('number', 'Electos');


			data.addRows([
					{% for partido in sitio.partidos.all %}
					['{{partido.nombre}}',{{ partido.electos|unlocalize }}],
					{% endfor %}
					]);

			// Set chart options
			var options = {'title':'Porcentaje de Escaños en {{ sitio.nombre }}',
				'width':365,
				'height':200,
			    'backgroundColor':'#f4f4f4'
				};

			// Instantiate and draw our chart, passing in some options.
			var chart = new google.visualization.PieChart(document.getElementById('chart_electos'));
			chart.draw(data, options);
		}

		</script>

</head>
<body>
	<div class="content">
		<div class="header_right">
			<div class="top_info">
				<div class="top_info_right">
					<p>Este parrafo esta hidden por si se quiere usar</p>					
				</div>		
			</div>
			{% block menutrio %}		
			<div class="bar">
				<ul>
					<li class="slogan"></li>
					
					<li><a href="/{{ sitio.comicio.id|unlocalize}}" >{{ sitio.comicio.nombre }}</a></li>
					<li><a href="/{{ sitio.comicio.id|unlocalize}}/{{ sitio.id|unlocalize }}" >{{sitio.nombre}}</a></li>
					
				</ul>
			</div>
			{% endblock %}
		</div>
			
		<div class="logo">
			<h1><a href="/" title="Demoleaks">Demo<span class="red">Leaks</span></a></h1>
			<p>Analizando nuestra democracia</p>
		</div>
		
		<div class="search_field">
			<form method="get" action=".">
				{{ form.as_table }}
				
				<p> <span class="search">Busca demoleaks</span>&nbsp;&nbsp; <input type="text" name="search" class="search" /> <input type="submit" value="Buscar" class="button" /></p>
			</form>
		</div>
		

		
		<div class="newsletter">
			<div class="bandera">
				<p><img src="/static/flag-icons/flags_iso/24/es.png" /></p>
			</div>
			<div class="bandera">
				<p><img src="/static/flag-icons/flags_iso/24/fr.png" /></p>
			</div>
			<div class="bandera">
				<p><img src="/static/flag-icons/flags_iso/24/pl.png" /></p>
			</div>

		</div>
		
		<div class="subheader">
			{% block primer_cuadro %}
        	<div class="subheader_izq">
		  		<div class="nombre_sitio"><a href="" title="{{ sitio.nombre }}">{{ sitio.nombre }}</a></div>
          		<div class="atributos_sitio">
        			<ul> 
            			<li>Numero de votos contabilizados:  </li>
            			<li>Numero de abstenciones:</li>
           				<li>Numero de votos en blanco:  </li>
            			<li>Numero de votos nulos: </li>
            			
            		</ul>
            	</div>
            	<div class="atributos_sitio_valores">
                    <ul> 
            			<li><span class="numero">{{ sitio.votos_contabilizados}}</span></li>
            			<li><span class="numero">{{ sitio.votos_abstenciones }}</span></li>
           				<li><span class="numero">{{ sitio.votos_blancos}}</span> </li>
            			<li><span class="numero">{{ sitio.votos_nulos}}</span></li>
            		</ul>
            	</div>
            	
        	</div>
        
            <div class="subheader_der">
            	<div class="caja_barra_demoleak">
            	<ul> 
            			<li><h1>Demoleak</h1></li>
            			</ul>
        			</div> 
            	<div class="barra_nivel" style="display:inline">
            		{{ sitio.demoleak }}
					<div id="progressbar-n"></div>
				</div>
        	</div>
        	{% endblock %}
		</div>

		{% block contenedor_gcharts %}
   		<div class="contenedor_gcharts">
			<div id="chart_votos" style="float: left;margin-right: 18px;"></div>
			<div id="chart_electos"></div>
		</div>
		{% endblock %}    
    
    
    	
		<div class="left">
			{% block listado_inferior %}
			<div class="left_articles">
				<h1>Lista de partidos</h1>
				<p>Aqui puedes ver uno a uno datos estadisticos sobre cada partido</p>
			</div>
			
			
			{% for partido in top_partidos %}			
			<div class="lt"></div>
			<div class="lbox">
				<div style="float:left">
					<h2>{{ partido.nombre }}</h2>
				</div>
				<div class="barra_partido">
					{{ partido.demoleak }}
					<div id="progressbar-{{partido.id|unlocalize}}"></div>
				</div>	
			</div>
			{% endfor %}
			{% endblock %}
			
			
			
			
		</div>	
        <div class="right">
            <h1>Lista de Anomalias</h1>
            {% for partido in lista_anomalias %}
            {% if partido.sitio.tipo == 3 %}
			<div class="rt"></div>
			<div class="right_articles">
                <p><a href="/{{partido.sitio.comicio.id|unlocalize}}/{{partido.sitio.id|unlocalize}}"> {{partido.nombre}}</a> ha obtenido demasiados escaños en <a href="/{{partido.sitio.comicio.id|unlocalize}}/{{partido.sitio.id|unlocalize}}"> {{partido.sitio}}</a></p>
				
            </div>
            {% endif %}
			{% endfor %}
		</div>	
		
		<div class="lista_sitios">
        	
	<div style="margin-bottom:10px">
				{% if sitio.tipo == 1 %}
				<h1>Lista de Comunidades Autonomas</h1>
				{% endif %}	
				{% if sitio.tipo == 2 %}
				<h1>Lista de Provincias</h1>
				{% endif %}	
				{% if sitio.tipo == 3 %}
				<h1>Lista de Municipios</h1>
				{% endif %}
				{% if sitio.tipo == 5 %}
				
				{% endif %}	
			</div>
          		
          		<div class="wrapper">
        			<ul> 
        				{% for hijo in hijos %}
            			<li><a href="/{{sitio.comicio.id|unlocalize}}/{{hijo.id|unlocalize}}"> {{hijo.nombre}}</a></li>
            			{% endfor %}
            		</ul>
            		<br />
            	</div>
        
		</div>
		
		
		
		<div class="footer">
			<p>Creado por: <a href="http://blog.avances123.com/" title="Visita mi blog">Avances123</a>  |   Quieres una <a href="https://github.com/avances123/formulas-electorales/issues/new" title="Visita el proyecto">nueva funcion?</a></p>
		</div>
	</div>
</body>
</html>
